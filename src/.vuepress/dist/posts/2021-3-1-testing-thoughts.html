<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Some thoughts on testing, data science, and collaboration | jsnctl.github.io</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.55ef159b.css" as="style"><link rel="preload" href="/assets/js/app.34255126.js" as="script"><link rel="preload" href="/assets/js/2.3d3c1302.js" as="script"><link rel="preload" href="/assets/js/11.d3b0b3f0.js" as="script"><link rel="prefetch" href="/assets/js/10.98065a24.js"><link rel="prefetch" href="/assets/js/3.0c5018c7.js"><link rel="prefetch" href="/assets/js/4.9caddd63.js"><link rel="prefetch" href="/assets/js/5.c6248402.js"><link rel="prefetch" href="/assets/js/6.7e9b0997.js"><link rel="prefetch" href="/assets/js/7.84960fab.js"><link rel="prefetch" href="/assets/js/8.af68b35e.js"><link rel="prefetch" href="/assets/js/9.249f8264.js">
    <link rel="stylesheet" href="/assets/css/0.styles.55ef159b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">jsnctl.github.io</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://hypervector.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hypervector
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  News
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://hypervector.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hypervector
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="some-thoughts-on-testing-data-science-and-collaboration"><a href="#some-thoughts-on-testing-data-science-and-collaboration" class="header-anchor">#</a> Some thoughts on testing, data science, and collaboration</h1> <h4 id="mar-1-2021"><a href="#mar-1-2021" class="header-anchor">#</a> Mar 1, 2021</h4> <p>One of my most-used (and personal favourite) Python packages <code>pytest</code> tweeted the question recently:</p> <blockquote class="twitter-tweet tw-align-center"><p lang="en" dir="ltr">What convinced you that writing tests was worthwhile?</p>— pytest.org (@pytestdotorg) <a href="https://twitter.com/pytestdotorg/status/1365417272219557890?ref_src=twsrc%5Etfw">February 26, 2021</a></blockquote> <script async="async" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> <p>The more common responses to this are typically along the lines of:</p> <ul><li>Tests enable us to make changes with confidence,</li> <li>Tests allow us to verify something new works as expected,</li> <li>Tests help us collaborate more effectively.</li></ul> <p>Most of us will have at least some professional experience that informs our held beliefs and opinions regarding software practice, including those that cover software testing. Speaking personally, my philosophy toward writing tests has been directly informed by experiences where testing would have saved time and sanity when dealing with a tricky bug, regression, or outage.</p> <p>Specifically on the last bullet re: collaboration, I'll admit this wasn't immediately obvious to me when I first started writing code in teams. Nowadays, I'm so convinced of this that I'd consider it a specific interest in my work as an engineer.</p> <h3 id="tests-for-collaboration"><a href="#tests-for-collaboration" class="header-anchor">#</a> Tests for collaboration</h3> <p>As a new start, or as a developer who hasn't worked on a particular project before, one of the first steps towards productivity is running a checkout locally and ensuring the tests pass. I'll often end up in the test suite fairly soon afterwads having a dig around too. There's a few tacit things that this achieves:</p> <ul><li>It draws a line in the sand from which contributions can begin,</li> <li>It (mostly) can ensure consistency across development environments,</li> <li>It often enables developers to understand the code quicker.</li></ul> <p>Well-written tests can communicate what's happening under the hood on some of the more complex aspects of your codebase. Tests <em>can</em> be leveraged to resemble documentation, but I've found even simply stepping-through a test example with a debugger can be the most effective way to understand a particularly tricky area I might be having some difficulty grokking.</p> <p>A great side effect of all this is in distributing the ownership of code. If there's a decent level of test coverage, I'm much more likely to be able to figure out what's going on and ship changes or fixes quicker as a less experienced contributor. This helps mitigate against individuals being the <em>go-to</em> for specific parts of the stack: a scenario that can grind progress to a halt.</p> <p>The good developer experiences I've had working on high quality codebases has led me to think a bit more deeply about areas where these practices might help elsewhere.</p> <h3 id="testing-and-data-science-features"><a href="#testing-and-data-science-features" class="header-anchor">#</a> Testing and data science features</h3> <p>I've been working either as or closely with data scientists for the past decade or so, and I'm a firm believer in high quality and testing when working with data-driven components. These are complex bits of kit — even a simple &quot;heuristic&quot; data science feature can be awkward to track regressions with in scenarios where there are multiple contributors and the development pace is quick. That's before we even consider some of the more heavyweight approaches in the machine learning space.</p> <p>The train-test cycle is already central to the process of constructing models and algorithms, but what about after this point? What's going on when we take the approach from the workbench of a Jupyter Notebook, and integrate it into a production context?</p> <p>There's some great material out there regarding tests and data science — from <a href="https://www.youtube.com/watch?v=Da-FL_1i6ps" target="_blank" rel="noopener noreferrer">writing unit tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as a first class contributions, to <a href="http://www.tdda.info/" target="_blank" rel="noopener noreferrer">integrating testing practice<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> right from the get-go in your data analysis workflow. It's a rapidly maturing area that we're all learning in — another excellent example of this can be seen in the broader move towards best practices with communities like <a href="https://mlops.community/" target="_blank" rel="noopener noreferrer">MLOps<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>I'm interested in how we can begin to build tests when shipping data-driven components that help with collaboration in teams — <strong>especially</strong> in those scenarios where not every contributor is necessarily a data science expert. Being able to demonstrate fitness and validation on each phase of a continuous integration pipeline, on each local build, or after each boilerplate or model-specific change is something that allows developers to remain confident dealing with these components.</p> <h3 id="introducing-hypervector"><a href="#introducing-hypervector" class="header-anchor">#</a> Introducing Hypervector</h3> <p>Constructing tests for a function or feature that relies on the empirical aspects of the data science development process can become a little more tricky than writing assertions elsewhere. Take a feature vector of <code>N</code> values — there's a multiplicity of valid input combinations that could be encountered. Generating, managing, and sharing test data for these across different contexts is often a cumbersome process.</p> <p>With this in mind, I'm currently focused on building tools that help this process with <a href="https://hypervector.io" target="_blank" rel="noopener noreferrer">Hypervector<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> — a testing and validation API specifically for generating data-driven tests to maintain confidence and improve observability for your data-driven features.</p> <p style="text-align:center;"><a href="https://hypervector.io"><img src="/blog/tests/hypervector.png" width="30%"></a></p> <p>Hypervector allows you to:</p> <ul><li>Build Ensembles of data-driven test cases,</li> <li>Retrieve test data via a canonical endpoint wherever it's required,</li> <li>Define Benchmarks of expected behaviour,</li> <li>Assert results are consistent, or flag diffs for investigation</li></ul> <p>all via the API directly, or with the <code>hypervector-wrapper</code> Python package.</p> <div class="language-json extra-class"><pre class="language-json"><code># definition.json
# Builds two dimensional feature vector of int and float types<span class="token punctuation">,</span>
# distributed across cases as uniform and Gaussian dists respectively        
        
<span class="token punctuation">{</span>
  <span class="token property">&quot;definition_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Example Definition&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;features&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;feature_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;feature_A&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;INTEGER&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;distribution&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNIFORM&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;min&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max&quot;</span><span class="token operator">:</span> <span class="token number">50</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;feature_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;feature_B&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FLOAT&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;distribution&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GAUSSIAN&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;mu&quot;</span><span class="token operator">:</span> <span class="token number">15.0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;sigma&quot;</span><span class="token operator">:</span> <span class="token number">2.5</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># set_up.py</span>
<span class="token comment"># Run once to define test data and benchmark for fn_under_test</span>

<span class="token keyword">from</span> data_service <span class="token keyword">import</span> fn_under_test
<span class="token keyword">import</span> hypervector
hypervector<span class="token punctuation">.</span>API_KEY <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span>

project <span class="token operator">=</span> hypervector<span class="token punctuation">.</span>Project<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span>
definition <span class="token operator">=</span> hypervector<span class="token punctuation">.</span>Definition<span class="token punctuation">.</span>new<span class="token punctuation">(</span>
    definition<span class="token operator">=</span><span class="token string">&quot;./definition.json&quot;</span><span class="token punctuation">,</span>
    project_uuid<span class="token operator">=</span>project<span class="token punctuation">.</span>project_uuid
<span class="token punctuation">)</span>

<span class="token comment"># generating test data</span>
ensemble <span class="token operator">=</span> hypervector<span class="token punctuation">.</span>Ensemble<span class="token punctuation">.</span>new<span class="token punctuation">(</span>
    definition_uuid<span class="token operator">=</span>definition<span class="token punctuation">.</span>definition_uuid<span class="token punctuation">,</span>
    size<span class="token operator">=</span><span class="token number">5000</span>  <span class="token comment"># 5k samples</span>
<span class="token punctuation">)</span>
test_cases <span class="token operator">=</span> hypervector<span class="token punctuation">.</span>Ensemble<span class="token punctuation">.</span>get<span class="token punctuation">(</span>ensemble<span class="token punctuation">.</span>ensemble_uuid<span class="token punctuation">)</span><span class="token punctuation">.</span>hypervectors

results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> test_case <span class="token keyword">in</span> test_cases<span class="token punctuation">:</span>
    result <span class="token operator">=</span> fn_under_test<span class="token punctuation">(</span>test_case<span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># define snapshot of expected behavour    </span>
hypervector<span class="token punctuation">.</span>Benchmark<span class="token punctuation">.</span>new<span class="token punctuation">(</span>
    ensemble_uuid<span class="token operator">=</span>ensemble<span class="token punctuation">.</span>ensemble_uuid<span class="token punctuation">,</span> 
    output<span class="token operator">=</span>results
<span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># test_fn_under_test.py</span>
<span class="token comment"># Run as part of every subsequent test suite</span>

<span class="token keyword">from</span> data_service <span class="token keyword">import</span> fn_under_test
<span class="token keyword">import</span> hypervector
hypervector<span class="token punctuation">.</span>API_KEY <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span>

<span class="token comment"># get test data</span>
tests <span class="token operator">=</span> hypervector<span class="token punctuation">.</span>Ensemble<span class="token punctuation">.</span>get<span class="token punctuation">(</span>ensemble<span class="token punctuation">.</span>ensemble_uuid<span class="token punctuation">)</span>

results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> test_case <span class="token keyword">in</span> tests<span class="token punctuation">.</span>hypervectors<span class="token punctuation">:</span>
    result <span class="token operator">=</span> fn_under_test<span class="token punctuation">(</span>test_case<span class="token punctuation">)</span>
    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

<span class="token comment"># assert all 5k results are consistent with Benchmark</span>
benchmark_result <span class="token operator">=</span> tests<span class="token punctuation">.</span>benchmarks<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>assert_equal<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
<span class="token keyword">assert</span> benchmark_result<span class="token punctuation">.</span>asserted <span class="token keyword">is</span> <span class="token boolean">True</span>
</code></pre></div><p>I'm really keen to speak to any engineers or data scientists who are interested in this area, and who might want to be an early adopter for our forthcoming alpha programme. Please feel free to get in touch via <a href="mailto:hello@hypervector.io">hello@hypervector.io</a>, or ping me on Twitter <a href="https://twitter.com/jsnctl" target="_blank" rel="noopener noreferrer">@jsnctl<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.34255126.js" defer></script><script src="/assets/js/2.3d3c1302.js" defer></script><script src="/assets/js/11.d3b0b3f0.js" defer></script>
  </body>
</html>
